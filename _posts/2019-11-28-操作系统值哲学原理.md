---
layout:     post
title:      操作系统
subtitle:   操作系统哲学原理
date:       2019/11/28
author:     zhaostu4
header-img: img/post-bg-ios10.jpg
catalog: true
tags:
	- 操作系统
    - 学习笔记
---

>> T:2019/11/28  W:四 17:0:11
[HTML]:@[TOC](操作系统值哲学原理)

# 第三章
- 如何 执行一个系统调用过程
	1) 参数逆序入栈(和函数调用相似),
	2) 系统调用代码入栈(或者放入约定好的寄存器)
	3) 使用陷入(`trap`, 一种中断方式)将控制交给操作系统
	4) 操作系统获取调用代码, 并找到系统调用函数的地址,并调转至该地址
	5) 执行调用函数
	6) 返回用户程序
	![在这里插入图片描述](https://img-blog.csdnimg.cn/20191106155119181.png#pic_center)

![Windows的内核态与用户态界限](https://img-blog.csdnimg.cn/20191106142114254.png#pic_center)
# 第五章 
![在这里插入图片描述](https://img-blog.csdnimg.cn/20191106152157542.png#pic_center)
- 现代操作系统的线程模型: 同时实现内核态和用户态线程管理, 其中内核态线程数量少,而用户态线程数量多, 内个内核态线程服务于一个或多个用户态线程. 我们将需要执行阻塞操作的线程设置为内核态线程,而不会执行阻塞操作的线程设置为用户态线程, 这两可以(避免用户态线程阻塞造成整个进程被阻塞),(也避免了内核态线程太多造成系统资源不足)
	- 用户态的执行系统负责进程内部线程在非阻塞时的切换
	- 内核态的操作系统负责阻塞线程的切换
![在这里插入图片描述](https://img-blog.csdnimg.cn/20191106153555616.png#pic_center)
- 系统调用过程中由用户态切换至内核态的过程
	- 调用参数逆序入栈
	- 将系统函数调用代码存入指定位置
	- 系统发现该代码为系统调用:
		- 设置处理器为内核态
		- 保存当前寄存器(栈指针, 程序计数器, 通用寄存器)
		- 将帧指针设置为内核栈地址
		- 将程序计数器设置为系统调用处理函数的起始地址
	- 系统调用处理函数执行系统调用,并调用指定内核的函数
